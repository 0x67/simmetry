generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("SHADOW_DATABASE_URL")
  // directUrl         = env("DIRECT_URL")
  // shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
}

model User {
  id              String           @id @default(uuid())
  name            String
  email           String           @unique
  password        String
  created_at      DateTime         @default(now()) @db.Timestamptz()
  updated_at      DateTime         @updatedAt @db.Timestamptz()
  forza_telemetry ForzaTelemetry[]

  @@map("users")
}

enum ForzaType {
  FH5
  FH4
  FM7
  FM8

  @@map("forza_type")
}

enum ForzaCarClass {
  D
  C
  B
  A
  S1
  S2
  S3
  X

  @@map("forza_car_class")
}

enum ForzaDriveType {
  FWD
  RWD
  AWD

  @@map("forza_drive_type")
}

model ForzaTelemetry {
  id        String
  user_id   String
  game_type ForzaType

  is_race_on Boolean  @default(false)
  date_time  DateTime @db.Timestamptz()

  car_id                Int            @db.Integer()
  car_class             ForzaCarClass
  car_performance_index Int            @db.Integer()
  drive_type            ForzaDriveType
  track_id              Int?           @db.Integer()

  num_cylinders      Int   @db.Integer()
  engine_max_rpm     Float @db.Real
  engine_idle_rpm    Float @db.Real
  engine_current_rpm Float @db.Real

  acceleration_x Float @db.Real
  acceleration_y Float @db.Real
  acceleration_z Float @db.Real

  velocity_x Float @db.Real
  velocity_y Float @db.Real
  velocity_z Float @db.Real

  angular_velocity_x Float @db.Real
  angular_velocity_y Float @db.Real
  angular_velocity_z Float @db.Real

  yaw   Float @db.Real
  pitch Float @db.Real
  roll  Float @db.Real

  normalized_suspension_travel_front_left  Float @db.Real
  normalized_suspension_travel_front_right Float @db.Real
  normalized_suspension_travel_rear_left   Float @db.Real
  normalized_suspension_travel_rear_right  Float @db.Real

  tire_slip_ratio_front_left  Float @db.Real
  tire_slip_ratio_front_right Float @db.Real
  tire_slip_ratio_rear_left   Float @db.Real
  tire_slip_ratio_rear_right  Float @db.Real

  wheel_rotation_speed_front_left  Float @db.Real
  wheel_rotation_speed_front_right Float @db.Real
  wheel_rotation_speed_rear_left   Float @db.Real
  wheel_rotation_speed_rear_right  Float @db.Real

  wheel_on_rumble_strip_front_left  Boolean
  wheel_on_rumble_strip_front_right Boolean
  wheel_on_rumble_strip_rear_left   Boolean
  wheel_on_rumble_strip_rear_right  Boolean

  wheel_in_puddle_front_left  Float @db.Real
  wheel_in_puddle_front_right Float @db.Real
  wheel_in_puddle_rear_left   Float @db.Real
  wheel_in_puddle_rear_right  Float @db.Real

  surface_rumble_front_left  Float @db.Real
  surface_rumble_front_right Float @db.Real
  surface_rumble_rear_left   Float @db.Real
  surface_rumble_rear_right  Float @db.Real

  tire_slip_angle_front_left  Float @db.Real
  tire_slip_angle_front_right Float @db.Real
  tire_slip_angle_rear_left   Float @db.Real
  tire_slip_angle_rear_right  Float @db.Real

  tire_combined_slip_front_left  Float @db.Real
  tire_combined_slip_front_right Float @db.Real
  tire_combined_slip_rear_left   Float @db.Real
  tire_combined_slip_rear_right  Float @db.Real

  suspension_travel_meters_front_left  Float @db.Real
  suspension_travel_meters_front_right Float @db.Real
  suspension_travel_meters_rear_left   Float @db.Real
  suspension_travel_meters_rear_right  Float @db.Real

  position_x Float? @db.Real
  position_y Float? @db.Real
  position_z Float? @db.Real

  speed  Float? @db.Real
  power  Float? @db.Real
  torque Float? @db.Real

  tire_temp_front_left  Float? @db.Real
  tire_temp_front_right Float? @db.Real
  tire_temp_rear_left   Float? @db.Real
  tire_temp_rear_right  Float? @db.Real

  boost             Float? @db.Real
  fuel              Float? @db.Real
  distance_traveled Float? @db.Real

  best_lap          Float? @db.Real
  last_lap          Float? @db.Real
  current_lap       Float? @db.Real
  current_race_time Float? @db.Real
  lap_number        Int?
  position          Int?

  acceleration Int?
  brake        Int?
  clutch       Int?
  handbrake    Int?
  gear         Int?
  steer        Int?

  normalized_driving_lane        Int?
  normalized_ai_brake_difference Int?
  tire_wear_front_left           Float? @db.Real
  tire_wear_front_right          Float? @db.Real
  tire_wear_rear_left            Float? @db.Real
  tire_wear_rear_right           Float? @db.Real

  user User @relation(fields: [user_id], references: [id])

  @@unique([user_id, game_type, date_time], name: "forza_telemetry_user_id_game_type_date_time_pkey")
  @@map("forza_telemetry")
}
